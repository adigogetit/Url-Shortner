<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>URL Shortener</title>
    <link rel="stylesheet" href="style.css" />
</head>

<body>

    <div class="card">
        <h1>URL Shortener</h1>

        <form class="url-form">

            <div class="form-group">
                <label>Enter URL:</label>
                <input type="url" name="url" placeholder="https://example.com" />
            </div>

            <div class="form-group">
                <label>Custom Short URL (Optional):</label>
                <input type="text" name="shortCode" placeholder="custom-alias" />

                <button type="submit">Shorten</button>
            </div>
        </form>

        <h2>Shortened URLs</h2>

        <div class="url-list">

        </div>
    </div>
    <script>
        // to get the form data
        const form = document.querySelector('.url-form');

        form.addEventListener('submit', (event) => {
            event.preventDefault();

            const formData = new FormData(event.target);
            const url = formData.get('url');
            const shortCode = formData.get('shortCode');

            //  fetch the data
            fetch('/shorten', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ url, shortCode })
            })
            .then(res => res.json())
            .then(data => {
                if (data.error) {
                    alert(data.error);
                } else {
                    const urlList = document.querySelector('.url-list');
                    const item = document.createElement('div');
                    item.className = 'url-item';
                    item.innerHTML = `<a href="${data.shortUrl}" target="_blank">${data.shortUrl}</a><span>  ${url}</span>`;
                    urlList.appendChild(item);
                }
            })
            .catch(err => alert('Error: ' + err.message));
        });
    </script>

</body>

</html>